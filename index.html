<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Google AdSense ì‚¬ì´íŠ¸ ì†Œìœ  í™•ì¸: AdSense ì½˜ì†”ì—ì„œ ì‚¬ì´íŠ¸ ì¶”ê°€ ì‹œ ë°›ì€ meta íƒœê·¸ë¡œ êµì²´í•˜ì„¸ìš”. -->
    <meta name="google-site-verification" content="ì—¬ê¸°ì—_AdSenseì—ì„œ_ë°›ì€_í™•ì¸ì½”ë“œ_ì…ë ¥" />
    <title>Arcane Archive - ì „ì„¤ì˜ ëŒ€ë„ì„œê´€</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+KR:wght@400;700&family=Nanum+Brush+Script&display=swap');

        :root {
            --ancient-gold: #c5a059;
            --stone-medium: #1a1a1f;
            --stone-dark: #0a0a0c;
            --leather-rich: #3d2b1f;
            --parchment: #f2e8cf;
        }

        body {
            font-family: 'Noto Serif KR', serif;
            background: radial-gradient(circle at center, #1a1a24 0%, #08080a 100%);
            color: #e2e2e2;
            overflow-x: hidden;
            min-height: 100vh;
        }

        /* 1. ë°°ê²½ ê±°ëŒ€ ì±… ë”ë¯¸ */
        .library-bg {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1;
            opacity: 0.7;
            display: flex;
            justify-content: space-around;
            align-items: flex-end;
            padding: 0;
            pointer-events: none;
        }

        .book-stack {
            width: 130px;
            display: flex;
            flex-direction: column-reverse;
            margin: 0 -15px; 
            transition: all 0.5s;
        }

        .bg-book {
            height: 14px;
            margin-bottom: 2px;
            background: #1e1e24;
            border-bottom: 1px solid rgba(255,255,255,0.05);
            border-left: 8px solid rgba(0,0,0,0.6); 
            width: 100%;
            border-radius: 1px;
            position: relative;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .bg-book::after {
            content: '';
            position: absolute;
            right: 0; top: 0; bottom: 0; width: 80%;
            background: linear-gradient(90deg, transparent, rgba(197, 160, 89, 0.08));
        }

        /* 2. ê³ ëŒ€ ë„ì„œê´€ ì±„ê´‘ íš¨ê³¼ */
        .god-rays {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle at 50% -5%, rgba(197, 160, 89, 0.35) 0%, transparent 85%);
            pointer-events: none;
            z-index: 1;
        }

        .magic-dust {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none;
            background-image: radial-gradient(circle, #fff 1px, transparent 1px);
            background-size: 100px 100px;
            opacity: 0.12;
            animation: moveDust 45s linear infinite;
            z-index: 0;
        }

        @keyframes moveDust {
            from { background-position: 0 0; }
            to { background-position: 1000px 1000px; }
        }

        /* 3. ì§ˆë¬¸ ì¹´ë“œ */
        .ancient-slab {
            animation: float 6s ease-in-out infinite;
            background: rgba(20, 20, 28, 0.9);
            backdrop-filter: blur(15px);
            border: 2px solid rgba(197, 160, 89, 0.5);
            box-shadow: 0 40px 100px rgba(0,0,0,0.9), 0 0 20px rgba(197, 160, 89, 0.15);
            border-radius: 4px;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotateX(1deg); }
            50% { transform: translateY(-12px) rotateX(0deg); }
        }

        /* 4. ë§ˆë„ì„œ(Grimoire) ë””ìì¸ ê°œì„  - í˜ë¦¼ì²´ í°íŠ¸ ì ìš© */
        .grimoire {
            width: 68px;
            height: 210px;
            position: relative;
            cursor: pointer;
            transition: all 0.5s cubic-bezier(0.165, 0.84, 0.44, 1);
            transform-style: preserve-3d;
            border-radius: 4px 8px 8px 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            writing-mode: vertical-rl;
            /* í˜ë¦¼ì²´ í°íŠ¸ ì ìš© */
            font-family: 'Nanum Brush Script', cursive;
            font-weight: normal;
            font-size: 1.4rem;
            color: rgba(255,255,255,0.9);
            box-shadow: -15px 15px 40px rgba(0,0,0,0.85);
            border-left: 8px solid rgba(0,0,0,0.4);
            letter-spacing: -1px;
        }

        .grimoire::before {
            content: '';
            position: absolute;
            left: 0; right: 0; top: 0; bottom: 0;
            background: linear-gradient(to bottom, 
                transparent 15%, rgba(0,0,0,0.4) 15.5%, rgba(0,0,0,0.4) 17%, transparent 17.5%,
                transparent 45%, rgba(0,0,0,0.4) 45.5%, rgba(0,0,0,0.4) 47%, transparent 47.5%,
                transparent 80%, rgba(0,0,0,0.4) 80.5%, rgba(0,0,0,0.4) 82%, transparent 82.5%
            );
            pointer-events: none;
        }

        .grimoire-decoration {
            position: absolute;
            top: 12px; bottom: 12px; left: 12px; right: 12px;
            border: 1px solid rgba(197, 160, 89, 0.4);
            pointer-events: none;
        }

        .grimoire:hover {
            transform: translateY(-45px) rotateY(-20deg) scale(1.15);
            filter: brightness(1.25) contrast(1.1);
            box-shadow: 35px 35px 70px rgba(0,0,0,0.9);
            z-index: 50;
        }

        /* ì„ ë°˜ */
        .stone-stair {
            height: 35px;
            background: linear-gradient(to bottom, #32323a, #08080a);
            border-radius: 2px;
            box-shadow: 0 30px 60px rgba(0,0,0,1);
            position: relative;
            z-index: 10;
            border-top: 1px solid rgba(197, 160, 89, 0.3);
        }

        /* ë²„íŠ¼ */
        .gold-btn {
            transition: all 0.4s;
            background: rgba(197, 160, 89, 0.15);
            border: 2px solid var(--ancient-gold);
            color: var(--ancient-gold);
            text-shadow: 0 0 15px rgba(197, 160, 89, 0.7);
            letter-spacing: 0.2em;
            font-weight: 700;
        }

        .gold-btn:hover {
            background: var(--ancient-gold);
            color: #050507;
            box-shadow: 0 0 50px var(--ancient-gold);
            transform: translateY(-4px);
        }

        /* ëª¨ë‹¬ ë° ê¸°íƒ€ */
        .modal-blur {
            display: none;
            backdrop-filter: blur(25px);
            background: rgba(0,0,0,0.85);
            transition: opacity 0.4s;
            z-index: 100;
        }

        .book-open-anim {
            animation: bookOpen 0.8s cubic-bezier(0.19, 1, 0.22, 1) forwards;
        }

        @keyframes bookOpen {
            from { transform: scale(0.9) translateY(40px); opacity: 0; }
            to { transform: scale(1) translateY(0); opacity: 1; }
        }

        .notification-toast {
            position: fixed;
            bottom: 3rem;
            left: 50%;
            transform: translateX(-50%);
            background: var(--ancient-gold);
            color: #050507;
            padding: 1.2rem 3rem;
            border-radius: 2px;
            font-weight: bold;
            box-shadow: 0 0 50px rgba(197, 160, 89, 0.5);
            z-index: 200;
            display: none;
            letter-spacing: 4px;
            text-transform: uppercase;
        }

        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body class="p-4 md:p-10 pt-20"> <!-- íƒ€ì´í‹€ì´ ì—†ì–´ì¡Œìœ¼ë¯€ë¡œ ìƒë‹¨ ì—¬ë°± ì¶”ê°€ -->
    <!-- ë°°ê²½ ì¥ì‹ë“¤ -->
    <div class="library-bg" id="bg-stacks"></div>
    <div class="god-rays"></div>
    <div class="magic-dust"></div>
    <div id="toast" class="notification-toast"></div>

    <!-- ì¤‘ì•™ ì§ˆë¬¸ êµ¬ì—­ -->
    <main class="max-w-4xl mx-auto relative z-10">
        <section class="ancient-slab p-16 mb-24 text-center">
            <div class="inline-block px-8 py-1 rounded-sm border border-yellow-800 text-yellow-600 text-[12px] mb-12 font-bold tracking-[0.5em] uppercase">
                Grand Mandate âš–ï¸
            </div>
            <h2 id="current-question-display" class="text-3xl md:text-5xl font-bold mb-16 leading-relaxed text-stone-100" style="font-family: 'serif'; text-shadow: 0 0 40px rgba(0,0,0,0.9);">
                "ì¥ì†¡ì˜ í”„ë¦¬ë Œì—ì„œ ë‹¹ì‹ ì´ <br class="hidden md:block">ê°€ì¥ ì¢‹ì•„í•˜ëŠ” ë§ˆë²•ì€ ë¬´ì—‡ì¸ê°€ìš”?"
            </h2>
            
            <div class="flex flex-col md:flex-row gap-8 justify-center">
                <button id="gen-question-btn" onclick="generateAiQuestion()" class="gold-btn px-14 py-6 font-bold flex items-center justify-center gap-4">
                    <span id="btn-text">âœ¨ AI ë§ˆë ¥ ì—°ì„±</span>
                </button>
                <button onclick="openWriteModal()" class="px-14 py-6 bg-stone-900/95 hover:bg-stone-800 text-stone-400 font-bold transition-all border border-stone-700 flex items-center justify-center gap-2 tracking-[0.3em]">
                    <span>ğŸ“ ê¸°ë¡ ë´‰ì¸</span>
                </button>
            </div>
        </section>

        <!-- ì•„ì¹´ì´ë¸Œ ì„¹ì…˜ -->
        <section>
            <div class="flex flex-wrap items-center justify-between gap-6 mb-14 px-8">
                <div class="flex items-center gap-6">
                    <span class="text-4xl opacity-50">ğŸ“œ</span>
                    <h3 class="text-2xl font-bold tracking-[0.3em] text-stone-400 uppercase">The Eternal Records</h3>
                    <span id="book-count" class="text-[12px] bg-stone-900 text-stone-500 px-5 py-1 border border-stone-800 font-bold">VOLUMES: 6</span>
                </div>
                <button onclick="getAiRecommendation()" class="text-[12px] text-yellow-800 hover:text-yellow-600 font-bold border-b border-yellow-900/50 pb-1 tracking-[0.3em] uppercase">
                    ğŸ”® ìš´ëª…ì˜ ê³„ì‹œ
                </button>
            </div>

            <div class="relative group mb-48">
                <div id="bookshelf" class="flex items-end justify-start gap-4 px-14 pb-1 overflow-x-auto min-h-[320px] scrollbar-hide">
                    <div class="grimoire bg-[#4e1a1a]" onclick="openGrimoire('ì¥ì†¡ì˜ í”„ë¦¬ë Œ', 'ê°€ì¥ ë´‰ì¸í•´ë‘ê³  ì‹¶ì€ ê¸°ì–µì€?', 'í˜ë©œê³¼ì˜ 10ë…„, ê·¸ ì§§ì§€ë§Œ ì˜ì›í•œ ì‹œê°„ì˜ ì¡°ê°ë“¤.')">
                        <div class="grimoire-decoration"></div>
                        í”„ë¦¬ë Œ
                    </div>
                    <div class="grimoire bg-[#1a2b4a] h-[240px]" onclick="openGrimoire('ê·€ë©¸ì˜ ì¹¼ë‚ ', 'ê°€ì¥ ëˆˆë¬¼ í˜ë ¸ë˜ ì£½ìŒì€?', 'ë Œê³ ì¿  ì¿„ì¥¬ë¡œì˜ ë§ˆì§€ë§‰ ë¯¸ì†Œ.')">
                        <div class="grimoire-decoration"></div>
                        ê·€ë©¸ì˜ì¹¼ë‚ 
                    </div>
                    <div class="grimoire bg-[#1b3b2a] h-[210px]" onclick="openGrimoire('ì£¼ìˆ íšŒì „', 'ê°€ì¥ ê°€ì§€ê³  ì‹¶ì€ ì˜ì—­ ì „ê°œëŠ”?', 'ë¬´ëŸ‰ê³µì²˜.')">
                        <div class="grimoire-decoration"></div>
                        ì£¼ìˆ íšŒì „
                    </div>
                    <div class="grimoire bg-[#5d4037] h-[260px]" onclick="openGrimoire('í•˜ì´í!!', 'ë‚´ ì‚¶ì„ ë°”ê¾¼ í•œ ë¬¸ì¥ì€?', 'ë¬´ìŠ¨ ì¼ì´ ìˆì–´ë„ ê³µì€ ë°˜ë“œì‹œ ì˜¬ë¼ì˜¨ë‹¤.')">
                        <div class="grimoire-decoration"></div>
                        í•˜ì´í!!
                    </div>
                    <div class="grimoire bg-[#281b3d] h-[230px]" onclick="openGrimoire('ìµœì• ì˜ ì•„ì´', 'ì‘í’ˆ ì† ê°€ì¥ ì¶©ê²©ì ì¸ ë§ˆë²•ì€?', 'ê±°ì§“ë§ì€ ê°€ì¥ ì§€ë…í•˜ê³  ì•„ë¦„ë‹¤ìš´ ë§ˆë²•ì´ë‹¤.')">
                        <div class="grimoire-decoration"></div>
                        ìµœì• ì˜ì•„ì´
                    </div>
                    <div class="grimoire bg-[#1c1c1c] h-[220px]" onclick="openGrimoire('ìŠ¤íŒŒì´íŒ¨ë°€ë¦¬', 'ì•„ëƒê°€ ë‹¹ì‹ ì˜ ë§ˆìŒì„ ì½ëŠ”ë‹¤ë©´?', 'ë‚´ ë•í›„ ê°™ì€ ë§ˆìŒì„ ë“¤í‚¤ê³  ë‹¹í™©í•´í•˜ëŠ” ì•„ëƒ.')">
                        <div class="grimoire-decoration"></div>
                        ìŠ¤íŒŒì´íŒ¨ë°€ë¦¬
                    </div>
                </div>
                <div class="stone-stair w-full"></div>
            </div>
        </section>
    </main>

    <!-- ëª¨ë‹¬ ìƒì„¸ -->
    <div id="modalOverlay" class="modal-blur fixed inset-0 flex items-center justify-center p-4" onclick="closeGrimoire()">
        <div id="grimoireContent" class="bg-[#e8dec9] text-[#2d241e] w-full max-w-2xl p-16 rounded-sm shadow-[0_0_150px_rgba(0,0,0,1)] relative book-open-anim border-l-[40px] border-[#36241a]" onclick="event.stopPropagation()" style="background-image: url('https://www.transparenttextures.com/patterns/parchment.png');">
            <div class="absolute top-8 right-10 text-4xl cursor-pointer opacity-30 hover:opacity-100 transition-opacity" onclick="closeGrimoire()">Ã—</div>
            <h3 id="m-title" class="text-4xl font-bold mb-12 font-serif text-[#36241a] border-b-2 border-[#36241a]/15 pb-8 tracking-tighter"></h3>
            <div class="space-y-16">
                <div>
                    <span class="text-[12px] uppercase tracking-[0.5em] text-[#36241a]/50 font-bold block mb-6">Imperial Inquiry</span>
                    <div class="text-2xl font-bold border-l-4 border-[#c5a059]/50 pl-8 py-3 italic text-[#4e342e]">
                        <span id="m-question"></span>
                    </div>
                </div>
                <div>
                    <span class="text-[12px] uppercase tracking-[0.5em] text-[#36241a]/50 font-bold block mb-6">Arcane Testimony</span>
                    <div class="text-2xl leading-relaxed font-serif pl-8 text-[#2d241e]">
                        <span id="m-body"></span>
                    </div>
                </div>
            </div>
            <div class="mt-24 pt-10 border-t border-[#36241a]/5 flex justify-between items-center text-[11px] text-[#36241a]/40 font-bold tracking-[0.4em]">
                <span>MANUSCRIPT REF: XA-773</span>
                <span id="m-date">FEBRUARY 13, 2026</span>
            </div>
        </div>
    </div>

    <div id="writeModal" class="modal-blur fixed inset-0 flex items-center justify-center p-4" onclick="closeWriteModal()">
        <div class="bg-[#0f0f12] border-2 border-yellow-900/40 w-full max-w-xl p-14 rounded-sm shadow-2xl relative" onclick="event.stopPropagation()">
            <h3 class="text-3xl font-bold text-yellow-700 mb-6 tracking-[0.3em] uppercase">Commit to Eternity</h3>
            <p id="write-q-display" class="text-stone-400 text-lg mb-14 italic border-l-4 border-yellow-900/30 pl-8"></p>
            <div class="mb-12">
                <label class="block text-[12px] font-bold text-stone-600 mb-4 uppercase tracking-[0.4em]">Codex Title</label>
                <input id="input-title" type="text" placeholder="ë§ˆë²•ì˜ ì´ë¦„ì„ ìƒˆê¸°ì‹­ì‹œì˜¤..." class="w-full bg-black/80 border border-stone-800 rounded-none px-6 py-6 focus:outline-none focus:border-yellow-900/50 text-stone-200 placeholder-stone-800">
            </div>
            <div class="mb-14 relative">
                <label class="block text-[12px] font-bold text-stone-600 mb-4 uppercase tracking-[0.4em]">Divine Insight</label>
                <textarea id="input-answer" rows="6" placeholder="ë‹¹ì‹ ì˜ ì‚¬ìœ ë¥¼ ë´‰ì¸í•˜ì‹­ì‹œì˜¤..." class="w-full bg-black/80 border border-stone-800 rounded-none px-6 py-6 focus:outline-none focus:border-yellow-900/50 text-stone-200 placeholder-stone-800"></textarea>
                <button onclick="refineWithAi()" class="absolute bottom-6 right-6 text-[11px] bg-yellow-900/20 hover:bg-yellow-900/50 text-yellow-600 border border-yellow-900/40 px-6 py-2 transition-all">
                    <span id="refine-text">âœ¨ AI ë¬¸ì¥ ì—°ì„±</span>
                </button>
            </div>
            <div class="flex gap-8">
                <button onclick="saveRecord()" class="flex-1 bg-yellow-900/30 hover:bg-yellow-900/60 text-yellow-600 font-bold py-6 tracking-[0.5em] transition-all uppercase text-sm border border-yellow-900/50">
                    ë´‰ì¸ ì™„ë£Œ
                </button>
                <button onclick="closeWriteModal()" class="px-12 py-6 bg-stone-900 text-stone-700 font-bold uppercase text-[12px] tracking-widest">ì·¨ì†Œ</button>
            </div>
        </div>
    </div>

    <script>
        const apiKey = "";
        let currentQuestion = "ì¥ì†¡ì˜ í”„ë¦¬ë Œì—ì„œ ë‹¹ì‹ ì´ ê°€ì¥ ë´‰ì¸í•´ë‘ê³  ì‹¶ì€ ê¸°ì–µì€ ë¬´ì—‡ì¸ê°€ìš”?";

        function createBgStacks() {
            const container = document.getElementById('bg-stacks');
            container.innerHTML = '';
            const stackCount = 14; 
            for(let i = 0; i < stackCount; i++) {
                const stack = document.createElement('div');
                stack.className = 'book-stack';
                const height = Math.floor(Math.random() * 35) + 25; 
                for(let j = 0; j < height; j++) {
                    const book = document.createElement('div');
                    book.className = 'bg-book';
                    book.style.width = (75 + Math.random() * 45) + '%';
                    const hue = 200 + Math.random() * 45;
                    book.style.backgroundColor = `hsl(${hue}, 18%, ${15 + Math.random() * 20}%)`;
                    book.style.transform = `rotate(${(Math.random() - 0.5) * 1.5}deg)`;
                    stack.appendChild(book);
                }
                container.appendChild(stack);
            }
        }
        
        window.onload = function() {
            createBgStacks();
        };

        async function callGemini(prompt, systemInstruction = "") {
            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
            const payload = {
                contents: [{ parts: [{ text: prompt }] }],
                systemInstruction: systemInstruction ? { parts: [{ text: systemInstruction }] } : undefined
            };
            for (let i = 0; i < 5; i++) {
                try {
                    const response = await fetch(url, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                    const result = await response.json();
                    return result.candidates?.[0]?.content?.parts?.[0]?.text || "ë§ˆë ¥ì´ ì†Œì§„ë˜ì—ˆìŠµë‹ˆë‹¤.";
                } catch (error) {
                    await new Promise(r => setTimeout(r, Math.pow(2, i) * 1000));
                }
            }
            return "ì„œê³ ì˜ íë¦„ì´ ë§‰í˜”ìŠµë‹ˆë‹¤.";
        }

        async function generateAiQuestion() {
            const btn = document.getElementById('gen-question-btn');
            const btnText = document.getElementById('btn-text');
            btn.disabled = true;
            btnText.innerText = "â³ ë§ˆë ¥ ì—°ì„± ì¤‘...";
            const res = await callGemini("ì• ë‹ˆë©”ì´ì…˜ì„ ì†Œì¬ë¡œ ê¹Šì€ ì‚¬ìœ ë¥¼ ëŒì–´ë‚´ëŠ” ì§ˆë¬¸ 1ê°œ. ì œë¦¬ì—ì˜ ë§íˆ¬.", "ë„ˆëŠ” ëª¨ë“  ë§ˆë²•ì˜ ì •ì  ì œë¦¬ì—ë‹¤.");
            currentQuestion = res.replace(/"/g, '').trim();
            document.getElementById('current-question-display').innerText = currentQuestion;
            btn.disabled = false;
            btnText.innerText = "âœ¨ AI ë§ˆë ¥ ì—°ì„±";
            showToast("MANDATE REVEALED");
        }

        async function refineWithAi() {
            const answer = document.getElementById('input-answer').value;
            const refineText = document.getElementById('refine-text');
            if (!answer) return;
            refineText.innerText = "â³ ì—°ì„± ì¤‘...";
            const refined = await callGemini(`ë‚´ìš©: "${answer}"\n\nê³ ëŒ€ ë§ˆë„ì„œí’ìœ¼ë¡œ ë‹¤ë“¬ì–´ì¤˜.`, "ë„ˆëŠ” í‰ë²”í•œ ê¸€ì„ ë§ˆë²• ë¬¸ì¥ìœ¼ë¡œ ë°”ê¾¸ëŠ” ì‚¬ì„œì•¼.");
            document.getElementById('input-answer').value = refined.trim();
            refineText.innerText = "âœ¨ AI ë¬¸ì¥ ì—°ì„±";
            showToast("RECORD REFINED");
        }

        async function getAiRecommendation() {
            showToast("COMMUNING WITH ARCHIVES...");
            const currentBooks = Array.from(document.querySelectorAll('.grimoire')).map(el => el.innerText).join(', ');
            const res = await callGemini(`ê¸°ë¡ë“¤: [${currentBooks}]. ì œë¦¬ì—ë‹µê²Œ ì• ë‹ˆ í•˜ë‚˜ ì¶”ì²œí•´ì¤˜.`, "ë„ˆëŠ” ì œë¦¬ì—ë‹¤.");
            openGrimoire('ìš´ëª…ì˜ ê³„ì‹œ', 'ê·¸ëŒ€ì—ê²Œ ë‚´ë¦¬ëŠ” ì§€ë ¹', res);
        }

        function showToast(m) {
            const t = document.getElementById('toast');
            t.innerText = m; t.style.display = 'block';
            setTimeout(() => t.style.display = 'none', 3000);
        }

        function openGrimoire(t, q, a) {
            document.getElementById('m-title').innerText = t;
            document.getElementById('m-question').innerText = q;
            document.getElementById('m-body').innerText = a;
            document.getElementById('modalOverlay').style.display = 'flex';
            setTimeout(() => document.getElementById('modalOverlay').style.opacity = '1', 10);
        }

        function closeGrimoire() {
            document.getElementById('modalOverlay').style.opacity = '0';
            setTimeout(() => document.getElementById('modalOverlay').style.display = 'none', 400);
        }

        function openWriteModal() {
            document.getElementById('write-q-display').innerText = `Q. ${currentQuestion}`;
            document.getElementById('writeModal').style.display = 'flex';
        }

        function closeWriteModal() {
            document.getElementById('writeModal').style.display = 'none';
        }

        function saveRecord() {
            const title = document.getElementById('input-title').value;
            const answer = document.getElementById('input-answer').value;
            if (!title || !answer) return;
            const colors = ['#3d1a1a', '#1a2b4a', '#1b3b2a', '#4e342e', '#281b3d', '#1c1c1c'];
            const color = colors[Math.floor(Math.random() * colors.length)];
            const height = Math.floor(Math.random() * 70) + 190;
            const newBook = document.createElement('div');
            newBook.className = `grimoire`;
            newBook.style.backgroundColor = color;
            newBook.style.height = `${height}px`;
            newBook.innerHTML = `<div class="grimoire-decoration"></div>${title}`;
            newBook.onclick = () => openGrimoire(title, currentQuestion, answer);
            document.getElementById('bookshelf').appendChild(newBook);
            document.getElementById('book-count').innerText = `VOLUMES: ${document.querySelectorAll('.grimoire').length}`;
            closeWriteModal();
            showToast("RECORD SEALED");
        }
    </script>
</body>
</html>