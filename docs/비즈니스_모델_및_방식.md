# Arcane Archive — 비즈니스 모델 및 추천 방식

## 1. 개요 및 사용자 플로우

### 서비스 요약

- 사용자가 **영상(영화/애니)** 을 검색한다.
- 해당 영상에 대한 **질문이 (OpenAI로) 생성**된다.
- 사용자가 **답을 저장**할수록 **한 권의 책**이 생기고, 그 책이 **두꺼워진다**.
- “전설의 대도서관” 테마에 맞춰, 영상 하나 = 한 권의 그리모와(마도서), 질문/답 = 그 책의 내용으로 표현한다.

### 사용자 플로우

```mermaid
flowchart LR
  A[영상 검색] --> B[영상 선택]
  B --> C[질문 생성]
  C --> D[답 입력/저장]
  D --> E[책 생성 또는 두께 증가]
  E --> F[책장에서 확인/공유]
```

1. **영상 검색**: 검색창에 영화/애니 제목 입력 → API로 결과 조회 (실시간 “검색 중…” 표시).
2. **영상 선택**: 결과 중 하나 선택.
3. **질문 생성**: “AI 마력 연성” 등 버튼으로 해당 영상에 대한 질문 1개 생성 (실시간 “질문을 연성하고 있습니다…” 표시).
4. **답 입력/저장**: “기록 봉인” 등으로 사용자가 답변 입력 후 저장.
5. **책 생성 또는 두께 증가**:  
   - 해당 영상에 대한 질문이 **처음** 생성된 경우 → **새 책(그리모와) 생성**.  
   - 이미 책이 있으면 → **답 저장 시 그 책의 두께만 증가**.
6. **책장에서 확인/공유**: 책장에 쌓인 책 목록 조회, 책 클릭 시 질문/답 확인, 카카오톡 등으로 질문 내용 공유.

---

## 2. 기술 선택 요약

| 영역 | 선택 | 비고 |
|------|------|------|
| **영상물 API** | TMDB (영화·TV/애니) + 필요 시 Jikan (애니 전용) | TMDB 무료, `language=ko-KR`로 한글 메타 활용. Jikan은 MyAnimeList 기반, 한글은 로컬 캐시/매핑 검토. |
| **질문 생성** | OpenAI API | 영상 메타(제목·장르·줄거리)를 넣고 “한 질문만, 한국어로” 생성. 비용·일관성 위해 프롬프트 제약. |
| **저장소** | 자체 백엔드 + DB | Node/Express 등 서버 + SQLite/PostgreSQL 등. 질문·답·책·사용자 모두 서버 DB에 저장. |
| **인증** | 선택적 로그인 | 비로그인(익명 ID) 가능. 로그인 시 이메일+비밀번호 또는 소셜(구글/카카오)로 기기 간 동기화·공유. |
| **카카오 공유** | Kakao JavaScript SDK | Kakao Developers 앱 생성 후, 질문 텍스트 + 서비스 링크 공유. |

---

## 3. 데이터 모델 요약

### 질문·답변 저장 위치

**질문/답은 “우리 서버 DB”에 저장한다.** (클라이언트 전용 저장은 사용하지 않음.)

### 테이블(또는 컬렉션) 예시

- **books**  
  - 영상 메타(제목, TMDB/Jikan ID, 타입: 영화/애니 등), 첫 질문 생성 시점, 두께 관련 값(답 개수 또는 글자 수 합).
- **questions**  
  - `book_id`(또는 영상 ID), 질문 텍스트, 생성 시점.
- **answers**  
  - `question_id`, 사용자 ID 또는 익명 ID, 답변 텍스트, 저장/수정 시점.
- **users** (로그인 도입 시)  
  - 이메일 또는 소셜 ID, 비밀번호(해시), 생성 시점. 익명 ID와의 연결 정책은 선택(나중에 “익명 → 계정 병합” 등).

---

## 4. 책 두꺼워짐 규칙

### 책 생성

- 특정 **영상**에 대해 **처음으로 질문이 생성된 시점**에, 해당 영상을 나타내는 **한 권의 책(books 레코드)** 을 생성한다.
- 이후 같은 영상에 대한 질문/답은 모두 이 책에 연결된다.

### 두꺼워짐 계산

- **방안 A (권장)**: **답변 개수**에 비례해 두께(예: spine 두께, 높이) 증가.  
  - 단순하고 직관적. “많이 답할수록 책이 두꺼워진다”로 표현하기 좋음.
- **방안 B (선택)**: 답변 **글자 수** 합산에 비례.  
  - 나중에 “내용이 많은 책”을 시각적으로 구분하고 싶을 때 옵션으로 도입 가능.

---

## 5. 로그인 정책

- **선택적 로그인**: 서비스 이용 시 **로그인 필수 아님**.
- **비로그인(익명)**  
  - 기기/세션에 **익명 ID**(예: UUID) 부여.  
  - 이 ID로 질문/답 저장 가능. “기록 봉인” 시 익명 사용자도 저장 가능.
- **로그인 시**  
  - 이메일+비밀번호 또는 소셜(구글/카카오 등)로 계정 연결.  
  - 기기 간 동기화, “내 책 목록”, 공유 시 “내가 쓴 질문/답” 연결.  
  - 구현 순서: **익명 사용 먼저** → **로그인은 그 다음** 권장.  
  - 로그인 후 기존 익명 데이터를 계정에 연결할지 여부는 정책으로 정해 두고, MD/구현_순서에 선택 사항으로 기술해 두면 됨.

---

## 6. 공유·실시간 조회 UX

### 카카오톡 공유

- Kakao Developers에서 앱 생성 후 **JavaScript SDK** 연동.
- 공유 내용: **질문 텍스트** + (선택) **서비스 링크**(해당 책/질문 페이지).
- “질문 내용 카카오톡으로 공유하기” 버튼 → 기본 또는 커스텀 메시지 템플릿으로 전송.

### Open API 조회 시 실시간 텍스트

- **영상 검색 API** 호출 중: “검색 중…” / “대도서관에서 찾고 있습니다…” 등 문구 표시.
- **OpenAI** 호출 중: “질문을 연성하고 있습니다…” 표시.
- 버튼 비활성화 또는 로딩 스피너 + 위 텍스트로 조회 중 상태를 명확히 표시한다.
